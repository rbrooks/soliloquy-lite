jQuery(document).ready(function(e){var b;e(".soliloquy-image-meta").hide();if(e("#soliloquy-width").length>0&&0==e("#soliloquy-width").val().length){e("#soliloquy-width").val(soliloquy.width)}if(e("#soliloquy-height").length>0&&0==e("#soliloquy-height").val().length){e("#soliloquy-height").val(soliloquy.height)}if(e("#soliloquy-speed").length>0&&0==e("#soliloquy-speed").val().length){e("#soliloquy-speed").val(soliloquy.speed)}if(e("#soliloquy-duration").length>0&&0==e("#soliloquy-duration").val().length){e("#soliloquy-duration").val(soliloquy.duration)}e(".soliloquy-size-more").on("click.soliloquySizeExplain",function(p){p.preventDefault();e("#soliloquy-explain-size").fadeToggle()});e("#soliloquy-area").on("click.soliloquyRemove",".remove-image",function(q){q.preventDefault();b=e(this).parent().attr("id");e("#soliloquy-upload").after('<span class="soliloquy-waiting"><img class="spinner" src="'+soliloquy.spinner+'" width="16px" height="16px" style="margin: 0 5px; vertical-align: bottom;" />'+soliloquy.removing+"</span>");var p={action:"soliloquy_remove_images",attachment_id:b,nonce:soliloquy.removenonce};e.post(soliloquy.ajaxurl,p,function(r){e("#"+b).fadeOut("normal",function(){e(this).remove();e(".soliloquy-waiting").fadeOut("normal",function(){e(this).remove()})})},"json")});e("#soliloquy-area").on("click.soliloquyModify",".modify-image",function(p){p.preventDefault();e("html").addClass("soliloquy-editing");b=e(this).next().attr("id");tb_show(soliloquy.modifytb,"TB_inline?width=640&height=500&inlineId="+b);e(document).contents().find("#TB_closeWindowButton").on("click.soliloquyIframe",function(){if(e("html").hasClass("soliloquy-editing")){e("html").removeClass("soliloquy-editing");tb_remove()}});e(document).contents().find("#TB_overlay").on("click.soliloquyIframe",function(){if(e("html").hasClass("soliloquy-editing")){e("html").removeClass("soliloquy-editing");tb_remove()}});return false});e(document).on("click.soliloquyMeta",".soliloquy-meta-submit",function(t){t.preventDefault();var r=e(this).parent().find(".soliloquy-meta-table").attr("id");var q=r.split("-");var p=q[3];var s={action:"soliloquy_update_meta",attach:p,id:soliloquy.id,nonce:soliloquy.metanonce};e("#"+r+" td").each(function(){var u=e(this).find("*");e.each(u,function(){var v=e(this).attr("class");var w=e(this).val();if("checkbox"==e(this).attr("type")){var w=e(this).is(":checked")?"true":"false"}s[v]=w})});e(this).after('<span class="soliloquy-waiting"><img class="spinner" src="'+soliloquy.spinner+'" width="16px" height="16px" style="margin: 0 5px; vertical-align: middle;" />'+soliloquy.saving+"</span>");e.post(soliloquy.ajaxurl,s,function(u){e(".soliloquy-waiting").fadeOut("normal",function(){e(this).remove()});var v=setTimeout(function(){e("html").removeClass("soliloquy-editing");tb_remove()},1000)},"json")});e("#soliloquy-area").on("click.soliloquyUpload","#soliloquy-upload",function(p){p.preventDefault();e("html").addClass("soliloquy-uploading");b=e(this).parent().prev().attr("name");tb_show(soliloquy.upload,"media-upload.php?post_id="+soliloquy.id+"&type=image&context=soliloquy-image-uploads&TB_iframe=true&width=640&height=500");e(document).contents().find("#TB_closeWindowButton").on("click.soliloquyIframe",function(){if(e("html").hasClass("soliloquy-uploading")){e("html").removeClass("soliloquy-uploading");tb_remove();a()}});e(document).contents().find("#TB_overlay").on("click.soliloquyIframe",function(){if(e("html").hasClass("soliloquy-uploading")){e("html").removeClass("soliloquy-uploading");tb_remove();a()}});return false});window.original_send_to_editor=window.send_to_editor;window.send_to_editor=function(p){if(b){tb_remove();e("html").removeClass("soliloquy-uploading");var q=setTimeout(function(){a()},1500)}else{window.original_send_to_editor(p)}};var b="";var f="";var n="";var g="";var k="";var m="";var o="";var j="";var i="";var h=e("#soliloquy-images");if(0!==h.length){h.sortable({containment:"#soliloquy-area",update:function(q,r){e(".soliloquy-waiting").show();var p={url:soliloquy.ajaxurl,type:"post",async:true,cache:false,dataType:"json",data:{action:"soliloquy_sort_images",order:h.sortable("toArray").toString(),post_id:soliloquy.id,nonce:soliloquy.sortnonce},success:function(s){e(".soliloquy-waiting").hide();return},error:function(t,u,s){e(".soliloquy-waiting").hide();return}};e.ajax(p)}})}function a(){var q={action:"soliloquy_refresh_images",id:soliloquy.id,nonce:soliloquy.nonce};var p="";e("#soliloquy-upload").after('<span class="soliloquy-waiting"><img class="spinner" src="'+soliloquy.spinner+'" width="16px" height="16px" style="margin: 0 5px; vertical-align: bottom;" />'+soliloquy.loading+"</span>");e.post(soliloquy.ajaxurl,q,function(r){e.each(r.images,function(t,s){var u=r.images[t];p+='<li id="'+u.id+'" class="soliloquy-image attachment-'+u.id+'"><img src="'+u.src+'" width="'+u.width+'" height="'+u.height+'" /><a href="#" class="remove-image" title="'+soliloquy.remove+'"></a><a href="#" class="modify-image" title="'+soliloquy.modify+'"></a><div id="meta-'+u.id+'" class="soliloquy-image-meta" style="display: none;"><div class="soliloquy-meta-wrap"><h2>'+soliloquy.metatitle+"</h2><p>"+soliloquy.metadesc+"</p>";if(u.before_image_meta_table){e.each(u.before_image_meta_table,function(v,w){p+=u.before_image_meta_table[v]})}p+='<table id="soliloquy-meta-table-'+u.id+'" class="form-table soliloquy-meta-table"><tbody>';if(u.before_image_title){e.each(u.before_image_title,function(v,w){p+=u.before_image_title[v]})}p+='<tr id="soliloquy-title-box-'+u.id+'" valign="middle"><th scope="row">'+soliloquy.title+'</th><td><input id="soliloquy-title-'+u.id+'" class="soliloquy-title" type="text" size="75" name="_soliloquy_uploads[title]" value="'+u.title+'" /></td></tr>';if(u.before_image_alt){e.each(u.before_image_alt,function(v,w){p+=u.before_image_alt[v]})}p+='<tr id="soliloquy-alt-box-'+u.id+'" valign="middle"><th scope="row">'+soliloquy.alt+'</th><td><input id="soliloquy-alt-'+u.id+'" class="soliloquy-alt" type="text" size="75" name="_soliloquy_uploads[alt]" value="'+u.alt+'" /></td></tr>';if(u.before_image_link){e.each(u.before_image_link,function(v,w){p+=u.before_image_link[v]})}p+='<tr id="soliloquy-link-box-'+u.id+'" valign="middle"><th scope="row">'+soliloquy.link+'</th><td><label class="soliloquy-link-url">'+soliloquy.url+'</label><input id="soliloquy-link-'+u.id+'" class="soliloquy-link" type="text" size="70" name="_soliloquy_uploads[link]" value="'+u.link+'" /><label class="soliloquy-link-title-label">'+soliloquy.linktitle+'</label><input id="soliloquy-link-title-'+u.id+'" class="soliloquy-link-title" type="text" size="40" name="_soliloquy_uploads[link_title]" value="'+u.linktitle+'" /><input id="soliloquy-link-tab-'+u.id+'" class="soliloquy-link-check" type="checkbox" name="_soliloquy_uploads[link_tab]" value="'+u.linktab+'"'+u.linkcheck+' /><span class="description">'+soliloquy.tab+"</span></td></tr>";if(u.before_image_caption){e.each(u.before_image_caption,function(v,w){p+=u.before_image_caption[v]})}p+='<tr id="soliloquy-caption-box-'+u.id+'" valign="middle"><th scope="row">'+soliloquy.caption+'</th><td><textarea id="soliloquy-caption-'+u.id+'" class="soliloquy-caption" rows="3" cols="75" name="_soliloquy_uploads[caption]">'+u.caption+"</textarea></td></tr>";if(u.after_meta_defaults){e.each(u.after_meta_defaults,function(v,w){p+=u.after_meta_defaults[v]})}p+="</tbody></table>";if(u.after_image_meta_table){e.each(u.after_image_meta_table,function(v,w){p+=u.after_image_meta_table[v]})}p+='<a href="#" class="soliloquy-meta-submit button-secondary" title="'+soliloquy.savemeta+'">'+soliloquy.savemeta+"</a></div></div></li>"});e("#soliloquy-images").html(p);e(".soliloquy-image-meta").hide()},"json");e(".soliloquy-waiting").fadeOut("normal",function(){e(this).remove()})}e("#soliloquy-dismiss-notice").on("click.soliloquyDismiss",function(q){q.preventDefault();var p={url:soliloquy.ajaxurl,type:"post",async:true,cache:false,dataType:"json",data:{action:"soliloquy_dismiss_notice",nonce:soliloquy.dismissnonce},success:function(r){e("#setting-error-tgmsp-upgrade-soliloquy").fadeOut();return},error:function(s,t,r){return}};e.ajax(p)});e(".soliloquy-show-addons").magnificPopup({items:{type:"inline",src:"#addons-image"},closeBtnInside:true,closeOnBgClick:true});e(".soliloquy-comparison-show").magnificPopup({items:{type:"inline",src:"#soliloquy-comparison"},closeBtnInside:true,closeOnBgClick:true});e(".soliloquy-do-upgrade").on("click.soliloquyUpgrade",function(q){q.preventDefault();var p=e(this);p.parent().slideUp(300,function(){p.parent().next().slideDown(300,function(){e('input[type="email"]').focus();e.getScript("https://checkout.stripe.com/v2/checkout.js").done()})})});var d=false,l=false;e(".soliloquy-start-upgrade").on("click",function(s){s.preventDefault();e(".text-danger").remove();var r=e(this),t=r.parent().parent().find('input[type="text"]').val(),q;if(!c(t)){e('<p style="margin-top:15px;" class="text-danger">'+soliloquy.danger+"</p>").appendTo(r.parent().parent());return}d=t;var p=function(u){q=u.id;e(".tgm-plugin-overlay").appendTo("body").show();e(".tgm-plugin-processing").css({top:(e(window).height()-e(".tgm-plugin-processing").outerHeight())/2,left:(e(window).width()-e(".tgm-plugin-processing").outerWidth())/2});e(window).resize(function(){e(".tgm-plugin-processing").css({top:(e(window).height()-jQuery(".tgm-plugin-processing").outerHeight())/2,left:(e(window).width()-e(".tgm-plugin-processing").outerWidth())/2})});e.getJSON("http://soliloquywp.com/?soliloquy-stripe-processing=true&stripe-token="+q+"&plugin="+r.data("plugin")+"&slug="+r.data("slug")+"&amount="+r.data("amount")+"&user-email="+d+"&callback=?",function(v){if(!v||e.isEmptyObject(v)){e(".tgm-plugin-processing h3").text(soliloquy.stripe_err)}if(v&&v.error){r.after('<p style="margin:15px 0 0;" class="text-danger">'+v.error+"</p>");e(".tgm-plugin-overlay").fadeOut(300);return}e(".tgm-plugin-processing h3").text(soliloquy.upgrade);l=v;e.post(soliloquy.ajaxurl,{action:"soliloquy_do_plugin_upgrade",download:l.download_url,key:l.license,single:l.single},function(w){if(w.error){e(".tgm-plugin-processing h3").text("There was an error installing the upgrade.");return}if(w.form){e(".tgm-plugin-processing h3").addClass("text-left").text("Oops - we need some more information before the upgrade can be installed!");e(".tgm-plugin-processing").append(w.form);e(".tgm-plugin-processing").css({top:(e(window).height()-e(".tgm-plugin-processing").outerHeight())/2,left:(e(window).width()-e(".tgm-plugin-processing").outerWidth())/2});e(document).on("click.installCredsAddon","#upgrade",function(D){D.preventDefault();var C=e(".tgm-plugin-processing h3").text();e(".tgm-plugin-processing h3").text("Working...");e(".soliloquy-inline-error").remove();var y=e(this).parent().parent().find("#hostname").val();var E=e(this).parent().parent().find("#username").val();var z=e(this).parent().parent().find("#password").val();var B=e(this);var x=e(this).parent().parent().parent().parent();var A={url:ajaxurl,type:"post",async:true,cache:false,dataType:"json",data:{action:"soliloquy_do_plugin_upgrade",download:l.download_url,key:l.license,single:l.single,hostname:y,username:E,password:z},success:function(F){if(F.error){e(".soliloquy-inline-error").remove();e(".tgm-plugin-processing h3").text("There was an error installing the upgrade.");return}if(F.form){e(B).after('<span class="soliloquy-inline-error" style="font-weight:bold;padding-left:5px;">The information provided was incorrect. Please try again to continue with the upgrade.</span>');e(".tgm-plugin-processing h3").text(C);return}window.location.href=F.page},error:function(G,H,F){return}};e.ajax(A)});return}window.location.href=w.page},"json")})};StripeCheckout.open({key:"pk_live_oFViDOfW8oyvaTHp9JrFVH3q",address:false,amount:r.data("amount"),currency:"usd",name:r.data("name"),description:r.data("desc"),panelLabel:r.data("panel"),image:soliloquy.stripe,token:p})});function c(q){var p=new RegExp(/^(("[\w-+\s]+")|([\w-+]+(?:\.[\w-+]+)*)|("[\w-+\s]+")([\w-+]+(?:\.[\w-+]+)*))(@((?:[\w-+]+\.)*\w[\w-+]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$)|(@\[?((25[0-5]\.|2[0-4][\d]\.|1[\d]{2}\.|[\d]{1,2}\.))((25[0-5]|2[0-4][\d]|1[\d]{2}|[\d]{1,2})\.){2}(25[0-5]|2[0-4][\d]|1[\d]{2}|[\d]{1,2})\]?$)/i);return p.test(q)}});